<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æŠ¥è¡¨åˆ—è¡¨ - ç¨‹åºå‘˜æŠ¥è¡¨ç”Ÿæˆå·¥å…·</title>
    <style>
        /* ========== CSSå˜é‡å®šä¹‰ ========== */
        :root {
            --primary-color: #409EFF;
            --success-color: #67C23A;
            --warning-color: #E6A23C;
            --danger-color: #F56C6C;
            --info-color: #909399;
            --border-radius: 4px;
            --box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);
            --spacing-sm: 8px;
            --spacing-md: 16px;
            --spacing-lg: 24px;
        }
        
        /* ========== å…¨å±€æ ·å¼ ========== */
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
        }
        
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            font-size: 14px;
            color: #303133;
            background-color: #f0f2f5;
            line-height: 1.5;
        }
        
        /* ========== å¸ƒå±€å®¹å™¨ ========== */
        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: var(--spacing-lg);
        }
        
        /* ========== é¡µé¢å¤´éƒ¨ ========== */
        .page-header {
            background: white;
            padding: var(--spacing-lg);
            margin-bottom: var(--spacing-lg);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .page-title {
            font-size: 20px;
            font-weight: 600;
            color: #303133;
        }
        
        /* ========== å·¥å…·æ  ========== */
        .toolbar {
            background: white;
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .search-box {
            width: 300px;
            padding: 8px 12px;
            border: 1px solid #DCDFE6;
            border-radius: var(--border-radius);
            font-size: 14px;
            transition: border-color 0.2s;
        }
        
        .search-box:focus {
            outline: none;
            border-color: var(--primary-color);
        }
        
        /* ========== æŒ‰é’®æ ·å¼ ========== */
        .btn {
            padding: 9px 15px;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .btn-primary {
            background: var(--primary-color);
            color: white;
        }
        
        .btn-primary:hover:not(:disabled) {
            background: #66b1ff;
        }
        
        .btn-text {
            background: transparent;
            color: var(--primary-color);
            padding: 0;
        }
        
        .btn-text:hover:not(:disabled) {
            color: #66b1ff;
        }
        
        .btn-text.btn-danger {
            color: var(--danger-color);
        }
        
        .btn-text.btn-danger:hover:not(:disabled) {
            color: #f78989;
        }
        
        /* ========== è¡¨æ ¼æ ·å¼ ========== */
        .table-container {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            overflow: hidden;
        }
        
        .table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .table thead {
            background: #fafafa;
        }
        
        .table th {
            padding: 12px 16px;
            text-align: left;
            font-weight: 600;
            color: #606266;
            border-bottom: 1px solid #EBEEF5;
        }
        
        .table td {
            padding: 12px 16px;
            border-bottom: 1px solid #EBEEF5;
            color: #606266;
        }
        
        .table tbody tr:hover {
            background: #f5f7fa;
        }
        
        .table tbody tr:last-child td {
            border-bottom: none;
        }
        
        /* ========== æ“ä½œæŒ‰é’®ç»„ ========== */
        .action-buttons {
            display: flex;
            gap: 8px;
        }
        
        /* ========== ç©ºçŠ¶æ€ ========== */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #909399;
        }
        
        .empty-icon {
            font-size: 64px;
            margin-bottom: var(--spacing-md);
        }
        
        .empty-text {
            font-size: 14px;
            margin-bottom: var(--spacing-md);
        }
        
        /* ========== åŠ è½½çŠ¶æ€ ========== */
        .loading-skeleton {
            padding: 16px;
        }
        
        .skeleton-item {
            height: 48px;
            background: linear-gradient(90deg, #f2f2f2 25%, #e6e6e6 50%, #f2f2f2 75%);
            background-size: 200% 100%;
            animation: loading 1.5s ease-in-out infinite;
            margin-bottom: 8px;
            border-radius: 4px;
        }
        
        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        
        /* ========== å¯¹è¯æ¡†æ ·å¼ ========== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .modal-overlay.show {
            display: flex;
            animation: fadeIn 0.3s ease;
        }
        
        .modal {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.5);
            width: 420px;
            max-width: 90%;
            animation: slideDown 0.3s ease;
        }
        
        .modal-header {
            padding: 20px 20px 10px;
            border-bottom: 1px solid #EBEEF5;
        }
        
        .modal-title {
            font-size: 16px;
            font-weight: 600;
            color: #303133;
        }
        
        .modal-body {
            padding: 20px;
            color: #606266;
            line-height: 1.6;
        }
        
        .modal-footer {
            padding: 10px 20px 20px;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        
        .btn-default {
            background: white;
            color: #606266;
            border: 1px solid #DCDFE6;
        }
        
        .btn-default:hover:not(:disabled) {
            color: var(--primary-color);
            border-color: var(--primary-color);
            background: #ecf5ff;
        }
        
        .btn-danger {
            background: var(--danger-color);
            color: white;
        }
        
        .btn-danger:hover:not(:disabled) {
            background: #f78989;
        }
        
        /* ========== Toastæç¤º ========== */
        .toast {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 12px 20px;
            border-radius: var(--border-radius);
            color: white;
            z-index: 2000;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.3);
            animation: slideDown 0.3s ease;
        }
        
        .toast-success { background: var(--success-color); }
        .toast-error { background: var(--danger-color); }
        .toast-warning { background: var(--warning-color); }
        .toast-info { background: var(--info-color); }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideDown {
            from { 
                opacity: 0;
                transform: translate(-50%, -20px);
            }
            to { 
                opacity: 1;
                transform: translate(-50%, 0);
            }
        }
        
        /* ========== æ ‡ç­¾æ ·å¼ ========== */
        .tag {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 2px;
            font-size: 12px;
        }
        
        .tag-success {
            background: #f0f9ff;
            color: var(--success-color);
            border: 1px solid #b3e19d;
        }
        
        .tag-info {
            background: #f4f4f5;
            color: var(--info-color);
            border: 1px solid #d3d4d6;
        }
    </style>
</head>
<body>
    <!-- ========== åº”ç”¨å®¹å™¨ ========== -->
    <div class="app-container">
        
        <!-- ========== é¡µé¢å¤´éƒ¨ ========== -->
        <div class="page-header">
            <h1 class="page-title">ğŸ“Š æŠ¥è¡¨åˆ—è¡¨</h1>
            <div style="color: #909399;">
                å½“å‰ç”¨æˆ·ï¼š<strong>å¼ ä¸‰ï¼ˆDESIGNERï¼‰</strong>
            </div>
        </div>
        
        <!-- ========== å·¥å…·æ  ========== -->
        <div class="toolbar">
            <input 
                type="text" 
                class="search-box" 
                id="searchInput"
                placeholder="æœç´¢æŠ¥è¡¨åç§°..."
            >
            <button class="btn btn-primary" id="createBtn">
                <span>â•</span> åˆ›å»ºæŠ¥è¡¨
            </button>
        </div>
        
        <!-- ========== è¡¨æ ¼å®¹å™¨ ========== -->
        <div class="table-container" id="tableContainer">
            <!-- åŠ è½½ä¸­éª¨æ¶å± -->
            <div class="loading-skeleton" id="loadingSkeleton">
                <div class="skeleton-item"></div>
                <div class="skeleton-item"></div>
                <div class="skeleton-item"></div>
            </div>
            
            <!-- æŠ¥è¡¨è¡¨æ ¼ -->
            <table class="table" id="reportTable" style="display: none;">
                <thead>
                    <tr>
                        <th>æŠ¥è¡¨åç§°</th>
                        <th>æŠ¥è¡¨æè¿°</th>
                        <th>åˆ›å»ºäºº</th>
                        <th>åˆ›å»ºæ—¶é—´</th>
                        <th>çŠ¶æ€</th>
                        <th style="width: 200px;">æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody id="reportTableBody">
                    <!-- åŠ¨æ€å¡«å…… -->
                </tbody>
            </table>
            
            <!-- ç©ºçŠ¶æ€ -->
            <div class="empty-state" id="emptyState" style="display: none;">
                <div class="empty-icon">ğŸ“‹</div>
                <div class="empty-text">æš‚æ— æŠ¥è¡¨æ•°æ®</div>
                <button class="btn btn-primary" onclick="handleCreate()">
                    <span>â•</span> åˆ›å»ºç¬¬ä¸€ä¸ªæŠ¥è¡¨
                </button>
            </div>
        </div>
        
    </div>
    
    <!-- ========== åˆ é™¤ç¡®è®¤å¯¹è¯æ¡† ========== -->
    <div class="modal-overlay" id="deleteModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">âš ï¸ ç¡®è®¤åˆ é™¤</h3>
            </div>
            <div class="modal-body" id="deleteModalBody">
                ç¡®å®šè¦åˆ é™¤æŠ¥è¡¨ <strong id="deleteReportName"></strong> å—ï¼Ÿ
                <br><br>
                <span style="color: var(--danger-color);">æ­¤æ“ä½œä¸å¯æ¢å¤ï¼</span>
            </div>
            <div class="modal-footer">
                <button class="btn btn-default" onclick="closeDeleteModal()">å–æ¶ˆ</button>
                <button class="btn btn-danger" id="confirmDeleteBtn">ç¡®è®¤åˆ é™¤</button>
            </div>
        </div>
    </div>
    
    <!-- ========== Toastå®¹å™¨ ========== -->
    <div id="toastContainer"></div>
    
    <script>
        // ========================================
        // æ¨¡æ‹Ÿæ•°æ®å®šä¹‰
        // ========================================
        
        /**
         * æ¨¡æ‹ŸæŠ¥è¡¨æ•°æ®
         */
        let mockReports = [
            {
                id: 1,
                reportName: 'ç”¨æˆ·æ³¨å†Œè¶‹åŠ¿åˆ†æ',
                reportDesc: 'åˆ†æè¿‘30å¤©çš„ç”¨æˆ·æ³¨å†Œæ•°æ®ï¼ŒæŒ‰æ—¥æœŸç»Ÿè®¡æ–°å¢ç”¨æˆ·æ•°',
                creator: 'å¼ ä¸‰',
                createdAt: '2025-12-20 10:30:00',
                status: 'published'
            },
            {
                id: 2,
                reportName: 'è®¢å•é‡‘é¢ç»Ÿè®¡',
                reportDesc: 'ç»Ÿè®¡å„åŒºåŸŸçš„è®¢å•æ€»é‡‘é¢å’Œå¹³å‡è®¢å•é‡‘é¢',
                creator: 'æå››',
                createdAt: '2025-12-18 14:20:00',
                status: 'published'
            },
            {
                id: 3,
                reportName: 'å®¢æˆ·æµå¤±é¢„è­¦',
                reportDesc: 'è¯†åˆ«è¿‘90å¤©æœªä¸‹å•çš„å®¢æˆ·ï¼Œè¿›è¡Œæµå¤±é¢„è­¦',
                creator: 'ç‹äº”',
                createdAt: '2025-12-15 09:15:00',
                status: 'draft'
            },
            {
                id: 4,
                reportName: 'äº§å“é”€å”®æ’è¡Œæ¦œ',
                reportDesc: 'ç»Ÿè®¡å„äº§å“çš„é”€å”®æ•°é‡å’Œé”€å”®é¢ï¼Œç”Ÿæˆæ’è¡Œæ¦œ',
                creator: 'å¼ ä¸‰',
                createdAt: '2025-12-10 16:45:00',
                status: 'published'
            }
        ];
        
        // ä»localStorageåŠ è½½æ•°æ®
        const savedReports = localStorage.getItem('mockReports');
        if (savedReports) {
            mockReports = JSON.parse(savedReports);
        }
        
        // å½“å‰ç­›é€‰çš„æŠ¥è¡¨åˆ—è¡¨
        let filteredReports = [...mockReports];
        
        // å¾…åˆ é™¤çš„æŠ¥è¡¨ID
        let reportToDelete = null;
        
        // ========================================
        // å·¥å…·å‡½æ•°
        // ========================================
        
        /**
         * é˜²æŠ–å‡½æ•°
         * @param {Function} fn è¦æ‰§è¡Œçš„å‡½æ•°
         * @param {number} delay å»¶è¿Ÿæ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
         */
        function debounce(fn, delay) {
            let timer = null;
            return function(...args) {
                clearTimeout(timer);
                timer = setTimeout(() => fn.apply(this, args), delay);
            };
        }
        
        /**
         * æ˜¾ç¤ºToastæç¤º
         * @param {string} message æç¤ºå†…å®¹
         * @param {string} type ç±»å‹ï¼šsuccess/error/warning/info
         * @param {number} duration æŒç»­æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
         */
        function showToast(message, type = 'info', duration = 3000) {
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            
            const icon = {
                success: 'âœ…',
                error: 'âŒ',
                warning: 'âš ï¸',
                info: 'â„¹ï¸'
            }[type] || 'â„¹ï¸';
            
            toast.innerHTML = `<span>${icon}</span><span>${message}</span>`;
            document.getElementById('toastContainer').appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'fadeIn 0.3s ease reverse';
                setTimeout(() => toast.remove(), 300);
            }, duration);
        }
        
        /**
         * ä¿å­˜æ•°æ®åˆ°localStorage
         */
        function saveToStorage() {
            localStorage.setItem('mockReports', JSON.stringify(mockReports));
        }
        
        // ========================================
        // é¡µé¢æ¸²æŸ“å‡½æ•°
        // ========================================
        
        /**
         * æ¸²æŸ“æŠ¥è¡¨åˆ—è¡¨
         */
        function renderReportList() {
            const tbody = document.getElementById('reportTableBody');
            const table = document.getElementById('reportTable');
            const emptyState = document.getElementById('emptyState');
            const skeleton = document.getElementById('loadingSkeleton');
            
            // éšè—éª¨æ¶å±
            skeleton.style.display = 'none';
            
            if (filteredReports.length === 0) {
                table.style.display = 'none';
                emptyState.style.display = 'block';
                return;
            }
            
            table.style.display = 'table';
            emptyState.style.display = 'none';
            
            tbody.innerHTML = filteredReports.map(report => `
                <tr data-id="${report.id}">
                    <td><strong>${report.reportName}</strong></td>
                    <td>${report.reportDesc || '-'}</td>
                    <td>${report.creator}</td>
                    <td>${report.createdAt}</td>
                    <td>
                        ${report.status === 'published' 
                            ? '<span class="tag tag-success">å·²å‘å¸ƒ</span>' 
                            : '<span class="tag tag-info">è‰ç¨¿</span>'}
                    </td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn btn-text" onclick="handleEdit(${report.id})">
                                âœï¸ ç¼–è¾‘
                            </button>
                            <button class="btn btn-text" onclick="handlePreview(${report.id})">
                                ğŸ‘ï¸ é¢„è§ˆ
                            </button>
                            <button class="btn btn-text" onclick="handlePermission(${report.id})">
                                ğŸ”’ æƒé™
                            </button>
                            <button class="btn btn-text btn-danger" onclick="handleDelete(${report.id})">
                                ğŸ—‘ï¸ åˆ é™¤
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }
        
        // ========================================
        // äº‹ä»¶å¤„ç†å‡½æ•°
        // ========================================
        
        /**
         * æœç´¢æŠ¥è¡¨
         */
        const handleSearch = debounce(function(keyword) {
            if (!keyword.trim()) {
                filteredReports = [...mockReports];
            } else {
                filteredReports = mockReports.filter(report => 
                    report.reportName.toLowerCase().includes(keyword.toLowerCase())
                );
            }
            renderReportList();
        }, 300);
        
        /**
         * åˆ›å»ºæŠ¥è¡¨
         */
        function handleCreate() {
            showToast('è·³è½¬åˆ°æŠ¥è¡¨åˆ›å»ºé¡µé¢...', 'info');
            // å®é™…é¡¹ç›®ä¸­è¿™é‡Œä¼šè·³è½¬åˆ°åˆ›å»ºé¡µé¢
            setTimeout(() => {
                window.location.href = 'report-create-step1-2.html';
            }, 1000);
        }
        
        /**
         * ç¼–è¾‘æŠ¥è¡¨
         */
        function handleEdit(reportId) {
            const report = mockReports.find(r => r.id === reportId);
            if (report) {
                showToast(`ç¼–è¾‘æŠ¥è¡¨: ${report.reportName}`, 'info');
                // å®é™…é¡¹ç›®ä¸­è¿™é‡Œä¼šè·³è½¬åˆ°ç¼–è¾‘é¡µé¢
                setTimeout(() => {
                    window.location.href = `report-create-step1-2.html?id=${reportId}`;
                }, 1000);
            }
        }
        
        /**
         * é¢„è§ˆæŠ¥è¡¨
         */
        function handlePreview(reportId) {
            const report = mockReports.find(r => r.id === reportId);
            if (report) {
                showToast(`é¢„è§ˆæŠ¥è¡¨: ${report.reportName}`, 'info');
                // å®é™…é¡¹ç›®ä¸­è¿™é‡Œä¼šè·³è½¬åˆ°é¢„è§ˆé¡µé¢
                setTimeout(() => {
                    window.location.href = `report-preview.html?id=${reportId}`;
                }, 1000);
            }
        }
        
        /**
         * æƒé™é…ç½®
         */
        function handlePermission(reportId) {
            const report = mockReports.find(r => r.id === reportId);
            if (report) {
                showToast(`é…ç½®æƒé™: ${report.reportName}`, 'info');
                // å®é™…é¡¹ç›®ä¸­è¿™é‡Œä¼šæ‰“å¼€æƒé™é…ç½®å¯¹è¯æ¡†æˆ–è·³è½¬é¡µé¢
            }
        }
        
        /**
         * åˆ é™¤æŠ¥è¡¨
         */
        function handleDelete(reportId) {
            const report = mockReports.find(r => r.id === reportId);
            if (report) {
                reportToDelete = reportId;
                document.getElementById('deleteReportName').textContent = report.reportName;
                document.getElementById('deleteModal').classList.add('show');
            }
        }
        
        /**
         * å…³é—­åˆ é™¤å¯¹è¯æ¡†
         */
        function closeDeleteModal() {
            document.getElementById('deleteModal').classList.remove('show');
            reportToDelete = null;
        }
        
        /**
         * ç¡®è®¤åˆ é™¤æŠ¥è¡¨
         */
        function confirmDelete() {
            if (reportToDelete) {
                const index = mockReports.findIndex(r => r.id === reportToDelete);
                if (index > -1) {
                    const deletedReport = mockReports[index];
                    mockReports.splice(index, 1);
                    saveToStorage();
                    
                    // æ›´æ–°ç­›é€‰åˆ—è¡¨
                    const searchKeyword = document.getElementById('searchInput').value;
                    if (!searchKeyword.trim()) {
                        filteredReports = [...mockReports];
                    } else {
                        filteredReports = mockReports.filter(report => 
                            report.reportName.toLowerCase().includes(searchKeyword.toLowerCase())
                        );
                    }
                    
                    renderReportList();
                    closeDeleteModal();
                    showToast(`æŠ¥è¡¨"${deletedReport.reportName}"å·²åˆ é™¤`, 'success');
                }
            }
        }
        
        // ========================================
        // äº‹ä»¶ç»‘å®š
        // ========================================
        
        document.addEventListener('DOMContentLoaded', function() {
            // åˆå§‹æ¸²æŸ“
            setTimeout(() => {
                renderReportList();
            }, 800); // æ¨¡æ‹ŸåŠ è½½å»¶è¿Ÿ
            
            // æœç´¢æ¡†äº‹ä»¶
            document.getElementById('searchInput').addEventListener('input', function(e) {
                handleSearch(e.target.value);
            });
            
            // åˆ›å»ºæŒ‰é’®äº‹ä»¶
            document.getElementById('createBtn').addEventListener('click', handleCreate);
            
            // ç¡®è®¤åˆ é™¤æŒ‰é’®äº‹ä»¶
            document.getElementById('confirmDeleteBtn').addEventListener('click', confirmDelete);
            
            // ç‚¹å‡»é®ç½©å±‚å…³é—­å¯¹è¯æ¡†
            document.getElementById('deleteModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeDeleteModal();
                }
            });
            
            // ESCé”®å…³é—­å¯¹è¯æ¡†
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    closeDeleteModal();
                }
            });
        });
    </script>
</body>
</html>