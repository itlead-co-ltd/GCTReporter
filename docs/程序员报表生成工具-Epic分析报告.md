# 程序员报表生成工具 - Epic分析报告

> **文档类型**: Epic分析与拆解策略
> **分析日期**: 2025-12-26
> **分析方法**: RTGO框架 + Epic拆解最佳实践
> **分析师角色**: 资深敏捷产品经理（CSPO认证）

---

## Epic概述

| 分析维度 | 内容 |
|---------|------|
| Epic名称 | 程序员报表生成工具 - MVP版本 |
| 业务价值 | 让开发人员快速创建、分享和管理SQL查询报表，提升数据查询效率，降低重复性数据提取工作 |
| 核心目标 | 构建三端分离的低代码报表平台，支持SQL查询管理、报表设计、权限控制和Excel导出，2周内交付MVP |
| 成功标准 | 完成16人日核心功能开发、通过40项P0验收点、性能指标达标（查询<3s、导出<5s）、无P0级Bug |
| 复杂度评估 | 中等 - 功能模块清晰、技术栈成熟、团队熟悉，但涉及三端架构、RBAC权限、动态SQL执行等中等复杂度需求 |

---

## 用户角色分析

| 用户角色 | 角色描述 | 核心诉求 | 主要场景 | 使用频率 |
|---------|---------|---------|---------|---------|
| 👤 管理员（ADMIN） | 系统最高权限拥有者，负责用户和角色管理 | 集中管理用户账号、角色分配、全局监控 | 系统初始化、新增/禁用用户、角色权限调整 | 低 |
| 👤 设计者（DESIGNER） | 报表设计和开发人员 | 快速创建报表、测试验证SQL、灵活配置参数和列、授权报表给特定角色 | 编写SQL查询、配置参数、测试预览、权限分配 | 中 |
| 👤 普通用户（VIEWER） | 报表的最终使用者 | 便捷查询已授权报表、快速导出数据、无需懂SQL | 查看报表列表、输入查询条件、查看结果、导出Excel | 高 |

### 角色优先级排序

1. **核心角色**: 普通用户（VIEWER）- 最终使用者，使用频率最高，业务价值直接体现在此角色的效率提升
2. **重要角色**: 设计者（DESIGNER）- 报表生产者，决定报表质量和可用性，是连接管理端和用户端的关键角色
3. **次要角色**: 管理员（ADMIN）- 支撑角色，使用频率低但对系统运维和权限管控至关重要

---

## 拆解策略

### 推荐拆解维度

**主维度**: 混合拆解（按用户角色 + 按功能模块）

**理由**: 
1. **三端分离架构明确** - 管理端、设计端、用户端各自功能边界清晰，天然适合按角色拆解
2. **核心功能模块独立** - SQL管理、报表设计、权限控制、Excel导出等模块相对独立，技术实现可并行
3. **用户视角清晰** - 按角色拆解能确保每个User Story都有明确的"为谁"，便于验收
4. **依赖关系可控** - 功能模块间依赖清晰（如"报表查询"依赖"报表模板设计"），易于排期

### 拆解框架

| 拆解分组 | 包含内容 | 预估故事数 | 优先级 |
|---------|---------|-----------|--------|
| 📦 基础设施层 | 用户登录/登出、Session管理、全局错误处理、数据库初始化 | 3个 | Must |
| 👤 管理端（ADMIN） | 用户管理（CRUD）、角色分配、用户搜索、批量操作 | 4个 | Must |
| 👤 设计端（DESIGNER）- 核心功能 | SQL编辑器、参数配置、列配置、报表CRUD | 5个 | Must |
| 👤 设计端（DESIGNER）- 预览与授权 | 报表预览（测试执行）、角色授权、权限管理 | 3个 | Must |
| 👤 用户端（VIEWER）- 查询功能 | 报表列表（权限过滤）、报表详情、参数输入、执行查询 | 4个 | Must |
| 👤 用户端（VIEWER）- 展示与导出 | 数据表格展示、分页排序、Excel导出 | 3个 | Must |
| 🔐 权限控制层（RBAC） | 角色定义、权限拦截器、权限缓存、执行日志 | 4个 | Must |
| 🔧 技术增强功能 | SQL安全校验、动态列渲染、性能优化 | 3个 | Should |
| 🎨 用户体验优化（V2） | 报表样式美化、参数联动、图表支持、定时任务 | 6个 | Could |

### 总体预估

- **预估用户故事总数**: 35个（Must: 26个、Should: 3个、Could: 6个）
- **建议迭代数**: 2个迭代（Sprint 1: 13-15个故事，Sprint 2: 11-13个故事）
- **核心功能占比**: 74%（26/35个）
- **MVP范围**: Must + Should = 29个故事

---

## 依赖与风险分析

### 关键依赖

| 依赖类型 | 依赖描述 | 影响范围 | 应对建议 |
|---------|---------|---------|---------|
| 技术依赖 | SpringBoot、Vue.js、Element UI、MySQL等技术栈的熟悉程度 | 所有功能模块 | ✅ 团队已熟悉，风险低 |
| 功能依赖 | 报表预览和报表查询都依赖"报表模板设计"完成 | 设计端预览、用户端查询 | 优先完成报表模板设计（Sprint 1前期） |
| 功能依赖 | Excel导出依赖报表查询功能 | 用户端导出 | 在报表查询完成后再开发导出（Sprint 2） |
| 功能依赖 | 所有端功能都依赖基础设施层（用户登录、权限拦截器） | 全部功能 | Sprint 1第一周完成基础设施 |
| 数据依赖 | 用户端报表列表需要权限数据（用户角色、报表权限） | 用户端查询 | 确保RBAC权限模型先完成 |

### 风险识别

| 风险点 | 风险等级 | 可能影响 | 缓解措施 |
|--------|---------|---------|---------|
| SQL注入安全风险 | 高 | 数据安全、系统稳定性 | ✅ 1. 强制SQL白名单校验<br>✅ 2. 只读数据库账号<br>✅ 3. PreparedStatement参数化<br>✅ 4. 查询超时控制 |
| 动态列渲染技术实现复杂 | 中 | 报表预览、报表查询功能 | ✅ 1. 利用ResultSet元数据提取列信息<br>✅ 2. Vue动态组件渲染<br>✅ 3. 预留1天技术攻坚时间 |
| Excel导出大数据量性能问题 | 中 | 用户端导出体验 | ✅ 1. MVP限制5000行导出<br>✅ 2. 超量提示用户添加筛选<br>✅ 3. V2考虑流式导出 |
| 权限校验性能瓶颈 | 中 | 所有功能的访问速度 | ✅ 1. 权限数据缓存（TTL=5分钟）<br>✅ 2. 数据库索引优化<br>✅ 3. 简化RBAC模型（三个固定角色） |
| 时间紧张，功能范围蔓延 | 高 | MVP按时交付 | ✅ 1. 严格控制MVP范围（26个Must故事）<br>✅ 2. V2功能坚决延期<br>✅ 3. 每日站会跟踪进度<br>✅ 4. 预留4人日Buffer |
| 团队仅2人，并行开发协调 | 中 | 开发效率、代码冲突 | ✅ 1. 明确分工（1人后端+1人前端）<br>✅ 2. API契约优先定义<br>✅ 3. Git分支管理规范<br>✅ 4. 每日代码评审 |
| 三端架构复杂度高 | 中 | 前端路由、状态管理 | ✅ 1. Vuex统一状态管理<br>✅ 2. 路由权限守卫<br>✅ 3. 组件复用（参数表单、数据表格） |

---

## 拆解建议与后续行动

### 拆解原则

1. **用户价值优先**: 每个User Story必须明确"作为{角色}，我想要{功能}，以便{价值}"
2. **独立可验收**: 每个Story完成后能独立演示和验收
3. **小而完整**: 单个Story工作量控制在0.5-2人日
4. **依赖前置**: 有依赖关系的Story按顺序排列（如"报表模板设计"在"报表预览"之前）

### 迭代划分建议

#### Sprint 1（第1周）- 基础设施 + 设计端核心

**目标**: 搭建框架，完成报表设计和预览功能

**Story列表**:

1. 📦 基础设施层（3个Story）
   - Story 1: 用户登录/登出功能
   - Story 2: Session管理与认证拦截器
   - Story 3: 数据库表结构初始化

2. 👤 管理端（2个Story）
   - Story 4: 用户管理（创建、编辑、禁用用户）
   - Story 5: 角色分配（为用户分配角色）

3. 👤 设计端核心功能（5个Story）
   - Story 6: SQL编辑器（支持语法高亮）
   - Story 7: 报表基本信息配置（名称、描述）
   - Story 8: 参数配置（添加、编辑、删除参数）
   - Story 9: 列配置（字段名、显示名称、列宽）
   - Story 10: 报表CRUD操作

4. 👤 设计端预览与授权（3个Story）
   - Story 11: 报表预览（测试执行SQL）
   - Story 12: 角色授权（为报表分配角色权限）
   - Story 13: 权限管理（查看和取消已授权角色）

5. 🔐 RBAC权限控制（2个Story）
   - Story 14: 角色定义与权限矩阵
   - Story 15: 权限拦截器（校验用户角色）

**预估**: 15个Story，约12人日

---

#### Sprint 2（第2周）- 用户端 + 优化增强

**目标**: 完成用户端查询和导出，系统联调测试

**Story列表**:

1. 👤 用户端查询功能（4个Story）
   - Story 16: 报表列表（权限过滤，仅显示已授权报表）
   - Story 17: 报表详情页面
   - Story 18: 参数输入表单（自动生成）
   - Story 19: 执行查询功能

2. 👤 用户端展示与导出（3个Story）
   - Story 20: 数据表格展示
   - Story 21: 分页和排序
   - Story 22: Excel导出功能

3. 🔐 RBAC权限完善（2个Story）
   - Story 23: 权限缓存机制
   - Story 24: 执行日志记录

4. 🔧 技术增强功能（3个Story）
   - Story 25: SQL安全校验（白名单+黑名单）
   - Story 26: 动态列渲染优化
   - Story 27: 性能监控与优化

5. 🧪 联调测试（1个Story）
   - Story 28: 端到端测试与Bug修复

**预估**: 13个Story，约10人日

---

### 用户故事详细拆解示例（前3个Story）

#### Story 1: 用户登录/登出功能

**作为** 系统用户
**我想要** 能够登录和登出系统
**以便** 安全地访问系统功能

**验收标准**:
- [ ] 登录页面包含用户名和密码输入框
- [ ] 输入正确的用户名密码后能成功登录
- [ ] 输入错误的用户名密码后提示错误信息
- [ ] 登录成功后跳转到对应角色的首页（管理端/设计端/用户端）
- [ ] 点击"登出"按钮能退出系统，清除Session
- [ ] 未登录用户访问受保护页面时自动跳转到登录页

**技术要点**:
- 后端：SpringBoot + Session认证
- 前端：Vue.js + Vue Router
- 密码加密：BCrypt

**工作量**: 0.5人日

---

#### Story 2: Session管理与认证拦截器

**作为** 系统开发者
**我想要** 实现Session管理和认证拦截器
**以便** 确保所有API都需要认证才能访问

**验收标准**:
- [ ] 实现Session存储用户信息（用户ID、用户名、角色）
- [ ] 实现拦截器，拦截所有API请求（除登录接口）
- [ ] 未登录用户访问API时返回401状态码
- [ ] Session超时时间设置为30分钟
- [ ] 每次请求都刷新Session过期时间

**技术要点**:
- SpringBoot HandlerInterceptor
- HttpSession管理

**工作量**: 0.5人日

---

#### Story 3: 数据库表结构初始化

**作为** 系统开发者
**我想要** 创建所有数据库表结构
**以便** 支持后续业务功能开发

**验收标准**:
- [ ] 创建user表（用户表）
- [ ] 创建role表（角色表）
- [ ] 创建user_role表（用户角色关联表）
- [ ] 创建report表（报表定义表）
- [ ] 创建report_param表（报表参数表）
- [ ] 创建report_column表（报表列配置表）
- [ ] 创建report_role_permission表（报表角色权限表）
- [ ] 创建report_execution_log表（报表执行日志表）
- [ ] 创建必要的索引
- [ ] 插入初始数据（默认管理员账号、三个角色）

**技术要点**:
- MySQL 5.7+
- Flyway或Liquibase数据库版本管理

**工作量**: 1人日

---

### 后续行动清单

- [ ] **立即行动**: 召开Epic拆解评审会，确认拆解策略
- [ ] **下一步**: 针对35个分组，编写详细User Story（使用INVEST原则）
- [ ] **第3步**: 为每个Story定义验收标准（Acceptance Criteria）
- [ ] **第4步**: 技术团队评估工作量（Story Point或人日）
- [ ] **第5步**: 产品负责人确认优先级，调整迭代计划
- [ ] **第6步**: Sprint 1启动会，明确第一周目标

---

## 附录：INVEST原则检查清单

所有User Story编写时需遵循INVEST原则：

- **I - Independent (独立性)**: Story之间尽量独立，减少依赖
- **N - Negotiable (可协商性)**: 实现细节可与开发团队协商
- **V - Valuable (有价值性)**: 每个Story对用户有明确价值
- **E - Estimable (可估算性)**: 开发团队能估算工作量
- **S - Small (小型化)**: 单个Story在一个迭代内可完成
- **T - Testable (可测试性)**: 有明确的验收标准

---

## 附录：拆解维度选择参考

| 拆解维度   | 适用场景       | 优点         | 缺点             | 本项目适用性 |
| ---------- | -------------- | ------------ | ---------------- | ------------ |
| 按用户角色 | 多角色复杂场景 | 用户视角清晰 | 可能有功能重复   | ✅ 高（三端分离） |
| 按功能模块 | 功能边界清晰   | 开发友好     | 可能忽略用户体验 | ✅ 高（模块独立） |
| 按使用场景 | 用户旅程复杂   | 端到端完整   | 可能跨越多个模块 | ⚠️ 中（场景相对简单） |
| 混合拆解   | 大型复杂Epic   | 灵活全面     | 需要更多协调     | ✅ 推荐（角色+功能） |

---

**分析完成时间**: 2025-12-26
**分析方法**: RTGO框架 + Epic拆解最佳实践
**分析质量**: 符合Epic分析标准（角色清晰、策略可执行、风险可控）
**下一步**: 编写详细User Story（建议使用Story编写提示词模板）

---

**文档状态**: 已完成 ✅
