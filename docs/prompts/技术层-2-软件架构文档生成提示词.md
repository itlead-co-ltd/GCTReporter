# 软件架构文档(SAD)生成提示词

> **📌 用途**：基于ADR技术决策，生成完整的软件架构文档(Software Architecture Document)
> **🎯 适用场景**：架构设计、技术方案评审、团队技术培训、架构知识沉淀
> **📚 参考标准**：IEEE 1471、ISO/IEC/IEEE 42010、4+1视图模型

---

## 🎭 R - 角色定义

你是一位资深软件架构师，拥有15年大型系统架构设计经验，擅长：

- 软件架构文档(SAD)编写与架构视图设计
- 4+1视图模型、C4模型等架构建模方法
- 架构风格选择（分层、微服务、事件驱动、CQRS等）
- 非功能需求分解与架构约束分析
- 架构决策追溯与技术债务管理

---

## 📋 T - 任务描述

基于以下输入材料，生成一份完整的软件架构文档(SAD)。

### 输入材料

#### 材料1：ADR文档

{这里粘贴所有相关的ADR文档，包括技术选型、架构决策等}

#### 材料2：需求文档（可选）

{这里粘贴PRD、用户故事或需求痛点描述}

#### 材料3：技术约束（可选）

{这里粘贴技术约束、非功能需求}

### 任务上下文

软件架构文档(SAD)用于：

1. **架构全局视图**：提供系统整体架构的文字描述和设计理念
2. **承上启下**：基于ADR技术决策，指导后续Schema/API设计
3. **评审依据**：为架构评审委员会提供完整的评审材料
4. **知识沉淀**：记录架构设计思路，避免知识流失

---

## 🎯 G - 目标与意图

### 核心目标

生成**结构完整、层次清晰、可追溯**的软件架构文档，确保架构设计可理解、可评审、可落地。

### 具体目标

1. **架构全局性**：提供系统整体视图，而非局部设计（Schema/API是局部，SAD是全局）
2. **决策可追溯**：所有架构设计追溯到ADR决策，说明"为什么这样设计"
3. **视图多样性**：使用多视图（逻辑视图、部署视图、数据视图）展示架构
4. **约束明确性**：清晰说明技术约束、非功能需求对架构的影响

### 业务价值

- **为管理层**：理解架构设计如何支撑业务目标，评估技术投资合理性
- **为架构师**：提供架构设计的完整蓝图，指导后续详细设计
- **为开发团队**：明确系统边界、模块职责、技术栈，减少理解偏差
- **为运维团队**：了解部署架构、依赖关系、监控要求

### 成功标准

- ✅ 包含8个核心章节（概述、架构视图、关键场景、质量属性、约束、决策追溯、风险、演进路线）
- ✅ 至少包含3个架构视图（逻辑视图、部署视图、数据视图）
- ✅ 所有架构设计追溯到ADR文档（引用ADR编号）
- ✅ 包含至少3个关键业务场景的架构流程分析
- ✅ 架构评审委员会通过（无P0级别问题）

---

## 📤 O - 输出要求

### 1. 输出结构（SAD文档8个章节）

#### 第1章：架构概述

```markdown
## 1. 架构概述

### 1.1 系统定位

**系统名称**：{从ADR或需求文档中提取项目名称}

**系统定位**：
{一句话概括系统的核心价值和业务目标}

### 1.2 核心设计理念

**设计原则**：
1. **{原则1名称}**：{说明该原则的含义和应用场景}
2. **{原则2名称}**：{说明该原则的含义和应用场景}
3. **{原则3名称}**：{说明该原则的含义和应用场景}

{根据项目特点补充更多原则}

### 1.3 架构风格

**主要架构风格**：{架构风格名称，如分层架构、微服务架构、事件驱动架构等}

**选择理由**：
{说明为什么选择这种架构风格，追溯到ADR决策或技术约束}

### 1.4 系统边界

**系统范围**：
- ✅ **包含**：{列出系统包含的核心功能模块}
- ❌ **不包含**：{列出明确不在系统范围内的功能}
```

---

#### 第2章：架构视图

使用**4+1视图模型**或**C4模型**展示架构。

##### 2.1 逻辑视图（Logical View）

**目标**：展示系统的功能分解和模块划分。

```markdown
## 2.1 逻辑视图

### 模块划分

{根据系统功能分解,使用表格展示核心模块}

| 模块名称 | 职责描述 | 核心组件 |
|---------|---------|---------|
| **{模块1}** | {该模块的职责} | {该模块包含的核心组件} |
| **{模块2}** | {该模块的职责} | {该模块包含的核心组件} |
| **{模块3}** | {该模块的职责} | {该模块包含的核心组件} |

### 模块依赖关系

{使用ASCII图或文字描述展示模块之间的依赖关系}

```

{模块A}
    ↓
{模块B} → {模块C}
    ↓       ↓
{模块D}  {外部系统}

```

### 关键设计决策

- **{决策点1}**：{说明设计决策内容，追溯到ADR或需求}
- **{决策点2}**：{说明设计决策内容，追溯到ADR或需求}
- **{决策点3}**：{说明设计决策内容，追溯到ADR或需求}
```

---

##### 2.2 部署视图（Deployment View）

**目标**：展示系统的物理部署和运行环境。

```markdown
## 2.2 部署视图

### 部署架构图

{使用ASCII图展示系统的物理部署结构，包括服务器、容器、客户端等}

```

{绘制部署架构图，展示各组件的部署位置和网络连接}

```

### 部署特点

- **{特点1}**：{说明部署方式的特点，如云原生、容器化、无状态等}
- **{特点2}**：{说明部署架构的优势}
- **{特点3}**：{说明外部依赖关系}

### 运行环境要求

| 组件/层次 | 环境要求 |
|----------|---------|
| **{组件1}** | {具体版本、配置要求} |
| **{组件2}** | {具体版本、配置要求} |
| **{组件3}** | {具体版本、配置要求} |
```

---

##### 2.3 数据视图（Data View）

**目标**：展示系统的数据流转和存储设计。

```markdown
## 2.3 数据视图

### 数据流转图

{使用ASCII图或文字描述展示系统的数据流向}

```

{数据从输入到输出的完整流程}

```

### 数据存储设计

| 数据类型 | 存储位置 | 容量/规模 | 生命周期 |
|---------|---------|----------|---------|
| **{数据类型1}** | {存储技术，如MySQL/Redis/LocalStorage} | {预估容量} | {保留策略} |
| **{数据类型2}** | {存储技术} | {预估容量} | {保留策略} |
| **{数据类型3}** | {存储技术} | {预估容量} | {保留策略} |

### 数据安全

- **{安全措施1}**：{说明数据安全相关的设计，如加密、权限控制等}
- **{安全措施2}**：{说明数据隐私保护措施}
- **{安全措施3}**：{说明数据备份与恢复策略}
```


```

### 数据存储设计

| 数据类型 | 存储位置 | 容量 | 生命周期 |
|---------|---------|------|---------|
| **系统列表** | LocalStorage | ~500KB | 永久（手动更新） |
| **模板配置** | LocalStorage | ~200KB | 永久（版本控制） |
| **用户行为日志** | LocalStorage | ~1MB | 30天（自动清理） |
| **AI响应缓存** | LocalStorage | ~500KB | 1小时（自动过期） |
| **信心度记录** | LocalStorage | ~100KB | 永久（分析用） |

**总计**：约2.3MB（远低于5MB限制）

### 数据安全

- **本地存储**：所有数据存储在用户浏览器本地，无需上传服务器
- **隐私保护**：需求描述仅发送到DeepSeek API（匿名化），不记录用户身份
- **数据导出**：提供数据导出功能，用户可手动备份
```

---

##### 2.4 开发视图（Development View）

**目标**：展示代码组织和技术栈。

```markdown
## 2.4 开发视图

### 代码组织结构

{展示项目的目录结构，使用树形图}

```

{项目根目录}/
├── {模块1}/
│   ├── {子模块1}/
│   └── {子模块2}/
├── {模块2}/
└── {配置文件}

```

### 技术栈

| 层次/组件 | 技术选型 | 版本 | 选择理由（追溯ADR） |
|----------|---------|------|-------------------|
| **{技术层1}** | {技术名称} | {版本} | {选择理由} |
| **{技术层2}** | {技术名称} | {版本} | {选择理由} |
| **{技术层3}** | {技术名称} | {版本} | {选择理由} |

### 开发规范

- **代码风格**：{如ESLint + Prettier，或其他代码规范}
- **提交规范**：{如Conventional Commits，或团队约定}
- **分支策略**：{如Git Flow，或其他分支模型}
- **单元测试**：{测试框架和覆盖率要求}
```

---

##### 2.5 场景视图（Scenario View）

**目标**：展示关键业务场景的架构流程。

```markdown
## 2.5 场景视图

### 场景1：{核心业务场景1名称}

**业务流程**：

{详细描述业务执行的步骤流程}

1. {步骤1}
2. {步骤2}
3. {步骤3}
   3.1 {子步骤1}
   3.2 {子步骤2}
4. {步骤4}

**架构组件交互**：

```

{组件A} → {组件B} → {组件C}
             ↓          ↓
         {组件D}    {外部系统}

```

**性能要求**：
- {性能指标1}：{量化标准}
- {性能指标2}：{量化标准}

---

### 场景2：{关键业务场景2名称}

**业务流程**：

{详细描述业务执行的步骤流程}

**架构组件交互**：

```

{展示组件间的调用关系}

```

---

### 场景3：{重要业务场景3名称}

**业务流程**：

{详细描述业务执行的步骤流程}

**架构组件交互**：

```

{展示组件间的调用关系}

```

{根据需要添加更多场景}
```

---

#### 第3章：质量属性(非功能需求)

```markdown
## 3. 质量属性

{基于ISO 25010质量模型,从以下维度描述系统质量属性要求}

### 3.1 性能效率(Performance Efficiency)

| 指标 | 要求 | 验证方法 | 追溯 |
|------|------|---------|------|
| **{性能指标1}** | {量化要求} | {验证方式} | {追溯到ADR或需求} |
| **{性能指标2}** | {量化要求} | {验证方式} | {追溯到ADR或需求} |
| **{性能指标3}** | {量化要求} | {验证方式} | {追溯到ADR或需求} |

### 3.2 可靠性(Reliability)

| 指标 | 要求 | 验证方法 | 追溯 |
|------|------|---------|------|
| **{可靠性指标1}** | {量化要求} | {验证方式} | {追溯到ADR或需求} |
| **{可靠性指标2}** | {量化要求} | {验证方式} | {追溯到ADR或需求} |

### 3.3 易用性(Usability)

| 指标 | 要求 | 验证方法 | 追溯 |
|------|------|---------|------|
| **{易用性指标1}** | {量化要求} | {验证方式} | {追溯到ADR或需求} |
| **{易用性指标2}** | {量化要求} | {验证方式} | {追溯到ADR或需求} |

### 3.4 安全性(Security)

| 指标 | 要求 | 验证方法 | 追溯 |
|------|------|---------|------|
| **{安全指标1}** | {量化要求} | {验证方式} | {追溯到ADR或需求} |
| **{安全指标2}** | {量化要求} | {验证方式} | {追溯到ADR或需求} |

### 3.5 可维护性(Maintainability)

| 指标 | 要求 | 验证方法 | 追溯 |
|------|------|---------|------|
| **{可维护性指标1}** | {量化要求} | {验证方式} | {追溯到ADR或需求} |
| **{可维护性指标2}** | {量化要求} | {验证方式} | {追溯到ADR或需求} |

{根据项目需要补充其他质量特性:兼容性、可移植性、功能适应性等}
```

---

#### 第4章:架构约束

```markdown
## 4. 架构约束

### 4.1 技术约束

| 约束类型 | 约束内容 | 对架构的影响 | 追溯来源 |
|---------|---------|------------|--------|
| **{技术约束1}** | {约束描述} | {影响说明} | {追溯到ADR或需求} |
| **{技术约束2}** | {约束描述} | {影响说明} | {追溯到ADR或需求} |
| **{技术约束3}** | {约束描述} | {影响说明} | {追溯到ADR或需求} |

### 4.2 资源约束

| 约束类型 | 约束内容 | 对架构的影响 | 追溯来源 |
|---------|---------|------------|--------|
| **{资源约束1}** | {约束描述} | {影响说明} | {追溯到ADR或需求} |
| **{资源约束2}** | {约束描述} | {影响说明} | {追溯到ADR或需求} |

### 4.3 业务约束

| 约束类型 | 约束内容 | 对架构的影响 | 追溯来源 |
|---------|---------|------------|--------|
| **{业务约束1}** | {约束描述} | {影响说明} | {追溯到ADR或需求} |
| **{业务约束2}** | {约束描述} | {影响说明} | {追溯到ADR或需求} |

### 4.4 组织约束

| 约束类型 | 约束内容 | 对架构的影响 | 追溯来源 |
|---------|---------|------------|--------|
| **{组织约束1}** | {约束描述} | {影响说明} | {追溯到ADR或需求} |
| **{组织约束2}** | {约束描述} | {影响说明} | {追溯到ADR或需求} |
```

---

#### 第5章:架构决策追溯

```markdown
## 5. 架构决策追溯

### 5.1 ADR决策映射

| ADR编号 | 决策内容 | 对架构的影响 | 架构体现章节 |
|--------|---------|-------------|------------|
| **{ADR-XXX}** | {决策内容摘要} | {影响说明} | {体现在SAD哪个章节} |
| **{ADR-XXX}** | {决策内容摘要} | {影响说明} | {体现在SAD哪个章节} |
| **{ADR-XXX}** | {决策内容摘要} | {影响说明} | {体现在SAD哪个章节} |

### 5.2 架构设计理由

{针对关键架构决策,展开说明设计理由}

#### {关键架构决策1标题}

**理由**:
1. **{理由维度1}**: {具体说明}
2. **{理由维度2}**: {具体说明}
3. **{理由维度3}**: {具体说明}

**追溯**:
- {追溯到哪个ADR或需求文档}
- {追溯到技术约束或业务要求}

#### {关键架构决策2标题}

**理由**:
{说明设计理由}

**追溯**:
{说明决策来源}

{根据需要添加更多架构决策说明}
```

---

#### 第6章:架构风险与应对

```markdown
## 6. 架构风险与应对

### 6.1 风险清单

| 风险ID | 风险描述 | 概率 | 影响 | 等级 | 应对措施 | 追溯 |
|--------|---------|------|------|------|---------|------|
| **R1** | {风险描述} | {高/中/低} | {高/中/低} | {🔴/🟡/🟢} | {应对措施} | {追溯来源} |
| **R2** | {风险描述} | {高/中/低} | {高/中/低} | {🔴/🟡/🟢} | {应对措施} | {追溯来源} |
| **R3** | {风险描述} | {高/中/低} | {高/中/低} | {🔴/🟡/🟢} | {应对措施} | {追溯来源} |

### 6.2 回滚方案

{说明关键风险的回滚策略,可引用ADR中的回滚条件}

**核心回滚策略**:
1. **{风险场景1}**: {回滚方案和预计时间}
2. **{风险场景2}**: {回滚方案和预计时间}
3. **{风险场景3}**: {回滚方案和预计时间}
```

---

#### 第7章:架构演进路线

```markdown
## 7. 架构演进路线

### 7.1 当前架构({版本号,如MVP/V1.0})

**核心特征**:
- ✅ {特征1}
- ✅ {特征2}
- ✅ {特征3}

**限制**:
- ❌ {限制1}
- ❌ {限制2}
- ❌ {限制3}

---

### 7.2 未来架构({规划版本,如V2.0})

**演进目标**:
- 🔄 {演进目标1}
- 🔄 {演进目标2}
- 🔄 {演进目标3}

**架构变化**:

{使用ASCII图展示架构演进}

```
当前架构
{当前架构简图}

↓ 演进

未来架构
{未来架构简图}
```

**演进时间表**:
- **{时间节点1}**: {里程碑内容}
- **{时间节点2}**: {里程碑内容}
- **{时间节点3}**: {里程碑内容}

---

### 7.3 技术债务管理

| 技术债务 | 说明 | 优先级 | 计划偿还时间 |
|---------|------|-------|-------------|
| **{债务1}** | {债务说明} | {P0/P1/P2/P3} | {偿还计划} |
| **{债务2}** | {债务说明} | {P0/P1/P2/P3} | {偿还计划} |
| **{债务3}** | {债务说明} | {P0/P1/P2/P3} | {偿还计划} |
```

---

#### 第8章:附录

```markdown
## 8. 附录

### 8.1 术语表

| 术语 | 全称 | 说明 |
|------|------|------|
| **SAD** | Software Architecture Document | 软件架构文档 |
| **ADR** | Architecture Decision Record | 架构决策记录 |
| **{术语1}** | {全称} | {解释说明} |
| **{术语2}** | {全称} | {解释说明} |

### 8.2 参考文档

{列出所有相关的参考文档}

- **{文档1}**: {文档描述}
- **{文档2}**: {文档描述}
- **{文档3}**: {文档描述}

### 8.3 版本历史

| 版本 | 日期 | 更新内容 | 作者 |
|------|------|---------|------|
| v1.0 | {日期} | 初始版本 | {作者} |
| v1.1 | {日期} | {更新说明} | {作者} |

### 8.4 审批记录

| 审批角色 | 姓名 | 审批结果 | 审批日期 | 意见 |
|---------|------|---------|---------|------|
| **架构师** | - | 待审批 | - | - |
| **技术委员会** | - | 待审批 | - | - |
| **项目经理** | - | 待审批 | - | - |
```

---

### 2. 质量要求

#### 决策可追溯性（强制）

- ✅ 所有架构设计必须追溯到ADR决策或需求文档
- ✅ 使用格式：`（追溯ADR-XXX）`或`（追溯需求文档第X章）`
- ✅ 无法追溯的设计，必须说明"基于行业最佳实践"并列入待确认

#### 视图完整性（强制）

- ✅ 至少包含3个架构视图：逻辑视图、部署视图、数据视图
- ✅ 复杂系统建议包含5个视图（4+1视图模型）
- ✅ 每个视图包含：图示+表格+文字说明

#### 场景覆盖度（强制）

- ✅ 至少包含3个关键业务场景的架构流程分析
- ✅ 每个场景包含：业务流程（步骤）+ 架构组件交互 + 性能要求
- ✅ 优先选择：核心功能场景或高风险场景

#### 质量属性量化（强制）

- ✅ 所有非功能需求必须量化（避免"性能好""可靠"等模糊表达）
- ✅ 使用具体指标：P95<Xs、准确率≥X%、成本<X元/月
- ✅ 每个指标说明验证方法

---

### 3. 格式规范

- **文档格式**：Markdown
- **表格**：用于结构化信息展示（视图对比、质量属性、风险清单）
- **图示**：使用ASCII图或PlantUML（部署架构图、数据流转图）
- **emoji**：增强可读性（✅/❌/🔴/🟡/🟢）
- **代码块**：用于架构图、目录结构、示例代码

---

### 4. 特别说明

#### SAD与ADR的区别

| 维度               | ADR（架构决策记录）           | SAD（软件架构文档）        |
| ------------------ | ----------------------------- | -------------------------- |
| **目标**     | 记录"为什么这样选择"          | 描述"整体是什么样子"       |
| **内容**     | 单个决策（如选择DeepSeek）    | 整体架构（所有决策的组合） |
| **粒度**     | 细粒度（一个技术选型）        | 粗粒度（整个系统架构）     |
| **数量**     | 多个ADR（ADR-001/002/003...） | 一个SAD                    |
| **更新频率** | 每次技术决策时新增            | 架构重大变更时更新         |

**关系**：

- SAD基于ADR生成（所有ADR的汇总+架构视图）
- SAD引用ADR（追溯决策来源）
- ADR是SAD的支撑文档

#### SAD与C4架构图的关系

| 维度           | SAD（软件架构文档）         | C4架构图                                      |
| -------------- | --------------------------- | --------------------------------------------- |
| **形式** | 文字描述为主                | 图形可视化为主                                |
| **内容** | 架构视图+设计理念+约束+风险 | 4层架构图（Context/Container/Component/Code） |
| **受众** | 架构师、评审委员会、管理层  | 技术团队、新人培训                            |

**关系**：

- C4架构图是SAD的可视化表达
- SAD第2章（架构视图）与C4架构图对应
- 建议同时维护：SAD（文字）+ C4图（可视化）

#### 信息不足的处理

如果输入材料缺少某些信息，你应该：

1. **合理推断**：基于ADR决策和行业最佳实践补充

   - 示例：ADR-002选择Chrome扩展 → 推断采用分层架构
2. **明确标注**：标注推断部分

   - 示例：`（基于行业最佳实践推断，需与团队确认）`
3. **列入待确认**：在附录中标注

   - 示例：`【待确认】是否需要缓存层（Redis）？`

---

### 5. 输出格式

直接输出完整的软件架构文档，包含8个章节：

1. 架构概述
2. 架构视图（5个视图）
3. 质量属性（非功能需求）
4. 架构约束
5. 架构决策追溯
6. 架构风险与应对
7. 架构演进路线
8. 附录

不要有任何前言或解释。

---

**📌 注意事项**：

1. SAD是架构设计的核心文档，承上启下（基于ADR，指导Schema/API）
2. SAD与C4架构图配套使用：SAD提供文字说明，C4提供可视化
3. SAD需定期更新（架构重大变更时），保持与代码一致
4. SAD需纳入版本控制（Git），确保可追溯
5. 所有架构决策必须在ADR中记录，SAD中引用
