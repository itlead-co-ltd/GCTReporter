# GCT Reporter - Claude Project Memory

> 项目记忆文档 - 用于快速恢复项目上下文
> 最后更新: 2026-02-06

---

## 🎯 项目核心信息

**项目定位**: 面向程序员的低代码报表生成工具
**架构模式**: 三端分离（管理端/设计端/用户端）
**团队规模**: 2名开发人员
**交付周期**: 2周（10个工作日）
**MVP工作量**: 39人日

---

## 💻 技术栈

### 后端
```yaml
语言: Java 17
框架: SpringBoot 3.1.x
ORM: Spring Data JPA
数据库:
  - 开发环境: SQLite 3.x
  - 生产环境: Oracle 12g
构建工具: Maven 3.8+
工具库: Lombok, Validation
```

### 前端
```yaml
框架: Vue 3.3.x (Composition API)
语言: TypeScript
UI组件: Element Plus
构建工具: Vite 4.x
状态管理: Pinia (推荐)
```

---

## 🔒 关键安全要求 (P0级别)

### SQL注入防护 - 强制要求

**必须使用参数化查询**:
```java
// ✅ 正确
NamedParameterJdbcTemplate.queryForList(sql, params);

// ❌ 禁止字符串拼接
sql.replace(":" + key, value);  // 危险！
```

**SQL白名单校验**:
- 仅允许SELECT语句
- 禁止关键字: DROP, DELETE, TRUNCATE, UPDATE, INSERT, ALTER, CREATE, EXEC
- 禁止注释符号: --, /*, */
- 查询超时: 5秒

**密码安全**:
- 强制使用BCrypt加密存储
- 禁止明文存储密码
- 日志脱敏，不记录密码

---

## ⚡ 性能要求

| 指标 | 要求 | 测试方法 |
|------|------|---------|
| 1000行数据查询 | P95 < 3秒 | JMeter 50并发 |
| Excel导出(1000行) | < 5秒 | 功能测试 |
| 报表列表加载 | < 1秒 | Lighthouse |
| 登录响应 | P95 < 2秒 | 50并发 |
| 5用户并发查询 | 无阻塞 | 并发测试 |

---

## 📋 代码规范要点

### Java后端

**命名规范**:
- 类名: PascalCase (ReportService)
- 方法名: camelCase (createReport)
- 常量: UPPER_SNAKE_CASE (MAX_ROWS)
- 布尔方法: is/has/can开头 (isValidSql)

**必用注解**:
```java
@Service
@RequiredArgsConstructor  // Lombok构造器
@Slf4j                    // Lombok日志
@Transactional(rollbackFor = Exception.class)
```

**异常处理**:
- 统一使用@ControllerAdvice全局异常处理
- 禁止吞掉异常
- 禁止仅printStackTrace
- 必须使用日志框架记录

**日志规范**:
- ERROR: 系统错误，需立即处理
- WARN: 警告信息，可继续运行
- INFO: 关键业务节点（登录、创建、删除）
- DEBUG: 调试信息，生产关闭
- 禁止使用System.out.println

### 前端规范

**组件命名**:
- 组件文件: PascalCase (ReportList.vue)
- 普通文件: kebab-case (report-service.ts)
- 变量: camelCase (userName)
- 常量: UPPER_SNAKE_CASE (MAX_UPLOAD_SIZE)

**Vue 3组合式API**:
```typescript
<script setup lang="ts">
// Props定义
interface Props { /* ... */ }
const props = withDefaults(defineProps<Props>(), { /* ... */ })

// Emits定义
const emit = defineEmits<{ /* ... */ }>()

// 响应式状态
const data = ref<Type | null>(null)

// 计算属性
const computed = computed(() => /* ... */)
</script>
```

---

## 🔀 Git提交规范 (Conventional Commits)

**格式**: `<type>(<scope>): <subject>`

**Type类型**:
- feat: 新功能
- fix: Bug修复
- docs: 文档更新
- style: 代码格式调整
- refactor: 重构代码
- perf: 性能优化
- test: 测试相关
- chore: 构建工具变动

**Scope范围**:
- user: 用户管理模块
- report: 报表管理模块
- param: 参数配置模块
- query: 查询执行模块
- export: Excel导出模块
- auth: 认证授权模块
- security: 安全相关

**示例**:
```bash
feat(report): 添加报表预览功能

- 实现SQL测试执行接口
- 添加参数输入表单
- 显示查询结果前100行

Closes #123
```

---

## 🌳 分支管理

**分支命名**:
```bash
main                        # 主分支，受保护
develop                     # 开发分支
feature/<Story编号>-<描述>  # 功能分支
bugfix/<描述>               # Bug修复分支
hotfix/<描述>               # 紧急修复分支
release/v1.0.0              # 发布分支
```

**main分支保护规则**:
- 必须通过Pull Request合并
- 至少1人Code Review通过
- 所有测试通过
- 无合并冲突
- 禁止直接推送

---

## 🧪 测试要求

**覆盖率目标**:
- 后端单元测试: >80% (强制)
- 后端集成测试: >60%
- 关键业务逻辑: 100%覆盖
- SQL安全测试: 100%场景覆盖
- 前端组件测试: >60%
- E2E测试: 核心流程100%覆盖

**必须测试的SQL注入场景**:
- DROP TABLE
- UNION注入
- 参数化查询防注入

---

## ✅ Definition of Done (DoD)

每个用户故事必须满足:
- [ ] 代码编写完成并通过编译
- [ ] 单元测试编写并通过(覆盖率>80%)
- [ ] 集成测试通过(关键接口)
- [ ] 代码审查通过(至少1人Review)
- [ ] 满足所有验收标准(AC)
- [ ] 无P0/P1级别Bug
- [ ] API文档更新(Swagger/JavaDoc)
- [ ] 提交到develop分支
- [ ] 通过静态代码检查(SonarLint/ESLint)
- [ ] 日志记录完整(关键操作)

---

## 📊 项目管理规范

### 迭代计划管理

**文档命名**: `docs/Sprint{N}-迭代任务计划.md`

**保护规则**:
- ❌ 禁止修改迭代计划文档
- ✅ 作为Sprint规划的基准文档
- ✅ 仅用于查阅Story和Task定义
- ✅ 用于Sprint回顾的对比基准

### 项目状态文档

**文档命名**: `PROJECT_STATUS_v{X}.{Y}.md`

**更新规则**:

**Story完成后必须更新**:
- [ ] 更新Story状态为✅已完成
- [ ] 更新所有Task状态和实际工时
- [ ] 记录Story完成时间
- [ ] 补充"最近完成的任务明细"章节
- [ ] 补充"Sprint开发日志"章节
- [ ] 更新Sprint整体进度和工时统计
- [ ] 同步更新README.md

**Task进行中更新**:
- [ ] 更新Story状态为🔧进行中
- [ ] 更新Task状态为🔧进行中
- [ ] 记录Task开始时间

**Task完成后更新**:
- [ ] 更新Task状态为✅已完成
- [ ] 记录Task实际工时和完成时间

### 开发日志规范

**Story开发日志格式**:
```markdown
### 📦 任务US00X: {Story标题} ({完成日期})

**任务目标**: {Story目标} | **预估工时**: {预估}h | **实际工时**: {实际}h ✅

#### 执行序列:

**🕘 {时间段} | {阶段名称} ({耗时}h)**

- ✅ {关键动作} - {结果描述}
- ✅ {决策点} - {决策内容和原因}
- **成果**: {阶段成果总结}
```

**日志质量标准**:
- ✅ 时间记录准确(精确到小时)
- ✅ 执行顺序清晰(分阶段记录)
- ✅ 关键动作完整(不遗漏重要步骤)
- ✅ 成果可量化(具体的验收标准)
- ✅ 问题有记录(遇到的阻碍和解决方案)

---

## 🚫 绝对禁止事项

1. ❌ 禁止提交敏感信息(密码、密钥、真实数据)
2. ❌ 禁止字符串拼接SQL
3. ❌ 禁止硬编码配置
4. ❌ 禁止吞掉异常
5. ❌ 禁止使用System.out.println
6. ❌ 禁止在生产环境使用console.log
7. ❌ 禁止直接推送到main分支
8. ❌ 禁止未经Review合并代码

---

## 📝 Code Review清单

### 功能性
- [ ] 实现了所有验收标准
- [ ] 处理了异常情况
- [ ] 无潜在空指针异常
- [ ] 边界条件考虑周全

### 安全性
- [ ] 使用参数化查询
- [ ] 无SQL注入风险
- [ ] 密码加密存储
- [ ] 敏感信息脱敏

### 性能
- [ ] 无N+1查询问题
- [ ] 索引添加合理
- [ ] 无不必要的循环
- [ ] 无内存泄漏风险

### 可维护性
- [ ] 命名清晰
- [ ] 无过长方法(>50行)
- [ ] 无重复代码
- [ ] 注释完整

### 测试
- [ ] 单元测试覆盖率达标
- [ ] 测试了异常场景
- [ ] 有集成测试

---

## 🎯 快速参考

**当你开始一个新Story时**:
1. 从develop创建feature分支
2. 更新项目状态文档(Story状态🔧进行中)
3. 按Task顺序执行
4. 每完成一个Task更新状态
5. Story完成后补充开发日志
6. 提交PR到develop，等待Review
7. 合并后同步更新README

**当你遇到安全相关代码时**:
- 首先检查SQL是否参数化
- 验证SQL白名单校验是否完整
- 确认日志不包含敏感信息
- 验证异常处理是否完整

**当你进行Code Review时**:
- 使用Code Review清单逐项检查
- 重点关注安全性和性能
- 验证测试覆盖率
- 确认符合命名规范

---

**文档版本**: v1.0
**生成时间**: 2026-02-06
**适用于**: Claude AI项目记忆系统
